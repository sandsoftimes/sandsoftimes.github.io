I"°<p>There are some problems which cannot be solved with a sequential model, therefore we need non-sequential model. Sequential model goes on with the assumption of single input and single output. What if youâ€™ve to predict two things? What if linear topology doesnot solve your problem.</p>

<p>In order to make non-sequential model, we use keras-functional-api. First of all import the model from keras,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.models import Model
</code></pre></div></div>

<p>Then simply create the model but donâ€™t run the cell and leave inputs and outputs empty for now,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model=Model(inputs=,outputs=)
</code></pre></div></div>

<p>Import all keras-layers,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.layers import *
</code></pre></div></div>

<p>Define an input shape for your model,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x=Input(shape=(3,))
</code></pre></div></div>

<p>Create hidden layers and output layers for the model,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hidden1=Dense(128,activation='relu')(x)
hidden2=Dense(64,activation='relu')(hidden1)
output1=Dense(1,activation='linear')(hidden2)
output2=Dense(1,activation='sigmoid')(hidden2)
</code></pre></div></div>

<p>You can see weâ€™ve two outputs for the above architecture one with the activation function of sigmoid and other with the linear function. Now go back to the cell which we left where we were creating the model and give the inputs and outputs,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model=Model(inputs=x,outputs=[output1,output2])
</code></pre></div></div>

<p>Now check the model summary,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.summary()
</code></pre></div></div>

<p><img src="/assets/images/clt/non-linear-neural-networks/2.png" alt="2" /></p>

<p>At the end plot the model for visual demonstration of model architecture,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.utils import plot_model
plot_model(model,show_shapes=True)
</code></pre></div></div>
<p>Here is how it will look,</p>

<p><img src="/assets/images/clt/non-linear-neural-networks/1.png" alt="1" /></p>

<p>Also for better understanding, you can go through this <a href="https://colab.research.google.com/drive/1uCHf6hoLR1a-46RznVjqnhVZNechF0fz?usp=sharing#scrollTo=ANFCCwXDDwvf">NOTEBOOK(functional-api-demo.ipynb)</a></p>

<h2 id="multi-input-model">Multi-Input Model</h2>

<p>Simply do the imports of Model and Layers,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.layers import *
from keras.models import Model
</code></pre></div></div>

<p>Then defined two inputs,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>inputA=Input(shape=(32,))
inputB=Input(shape=(128,))
</code></pre></div></div>

<p>Define first branch for first input,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x=Dense(8,activation="relu")(inputA)
x1=Dense(4,activation="relu")(x)
</code></pre></div></div>

<p>and second branch for second input,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>y=Dense(64,activation="relu")(inputB)
y1=Dense(32,activation="relu")(y)
y2=Dense(4,activation="relu")(y1)
</code></pre></div></div>

<p>combine output of both branches,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>combined=concatenate([x1,y2])
</code></pre></div></div>

<p>then apply fully connected layer on combined output,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># apply a FC layer and then a regression prediction on the
# combined outputs
z = Dense(2, activation="relu")(combined)
z1 = Dense(1, activation="linear")(z)
</code></pre></div></div>

<p>define the model and its input at the end,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># our model will accept the inputs of the two branches and
# then output a single value
model = Model(inputs=[inputA, inputB], outputs=z1)
</code></pre></div></div>

<p>Check the model summary,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.summary()
</code></pre></div></div>

<p><img src="/assets/images/clt/non-linear-neural-networks/3.png" alt="3" /></p>

<p>at the end plot the model,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.utils import plot_model
plot_model(model)
</code></pre></div></div>

<p><img src="/assets/images/clt/non-linear-neural-networks/4.png" alt="4" /></p>

<p>You can check out this <a href="http://localhost:4000/2021/02/15/non-linear-neural-networks">NOTEBOOK(functional-api-multiple-input.ipynb)</a>.</p>

<h2 id="age-gender-project">Age Gender Project</h2>

<p>Do necessary imports,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!mkdir -p ~/.kaggle
!cp kaggle.json ~/.kaggle/
</code></pre></div></div>

<p>download the dataset on your notebook,</p>

:ET